name: Deploy to Hugging Face Spaces

on:
  push:
    branches: [ main ]
  workflow_dispatch: {}

jobs:
  push-to-space:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # Optional: ensure only the essentials are pushed
      - name: Prepare deploy folder
        run: |
          rm -rf dist && mkdir -p dist
          rsync -a \
            --exclude ".git" \
            --exclude ".github" \
            --exclude ".venv" \
            --exclude "__pycache__" \
            --exclude ".pytest_cache" \
            --exclude "node_modules" \
            --exclude "*.zip" \
            ./ dist/

      - name: Push to Space
        uses: huggingface/action-push-to-space@v1
        with:
          repo-token: ${{ secrets.HF_TOKEN }}           # HF write token
          space: ${{ vars.HF_SPACE }}                   # e.g. shamikae/procore-ai-field-assistant
          directory: dist                               # push only the prepared folder